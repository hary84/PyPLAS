<div class="node question card my-2 ms-3 me-2 position-relative" id="q-id-{{ q_id }}" q-id="{{ q_id }}" ptype="{{ ptype }}" progress="{{ progress }}">
	<div class="for-toast">
		{% module Template("modules/toast.html") %}
	</div>
	<div class="card-header bg-success-subtle d-flex">
		Question
		{% if ptype == 0 %}
			<span class="ms-2 fw-bold text-secondary">HTML</span>
		{% elif ptype == 1 %}
			<span class="ms-2 fw-bold text-secondary">Code Test</span>
		{% end %}

		{% if user == 0 %}
			<span class="progress-badge badge rounded-pill ms-auto"> </span>
		{% elif user == 1 %}
			<div class="ms-auto d-flex">
				{% if ptype == 1 %}
					<div class="form-check form-switch">
						<input class="form-check-input editable-flag" type="checkbox" role="switch" {{'checked' if editable else "" }}>
						<label class="form-check-label" >Editable</label>
					</div>
				{% end %}
				<div class="vr mx-2 my-1"></div>
				<button type="button" class="btn btn-danger" onclick="delme(this)"><i class="bi bi-trash"></i></button>
			</div>
		{% end %}
	</div>
	<div class="card-body py-2">

		<!-- HTML Problem -->
		{% if ptype == 0 %}
			{% module Explain(editor=user, content=question, allow_del=False) %}
		{% end %}

		<!-- Code Writing Problem -->
		{% if ptype == 1 %}
			<div class="q-text mb-2">
				<p class="mb-0"><span class="badge bg-success">Question</span></p>
				{% module Explain(editor=user, content=question, allow_del=False) %}
			</div>

			<div class="q-content ms-4 px-2">
				{% if ptype == 1 and editable == True and user == 0%}
					<div class="ipynb-loader mb-3 border border-start-0 border-end-0 border-dark border-3 pb-2 bg-dark-subtle text-center">
						<label for="ipynbForm" class="form-label mb-1">Answer from Jupyter Notebook</label>
						<input class="form-control form-control-sm w-50 mx-auto border border-dark" id="ipynbForm" type="file" 
							accept=".ipynb" name="mynote" 
							onchange="loadIpynb(this, this.closest('.q-content'), markdown=false, {
								user: 0, 
								inQ: true
							})">
					</div>
				{% end %}
				{% if user == 1 %}
					{% module NodeControl(question=False) %}
					{% for d in conponent %}
						{% if d["type"] == "explain" %}
							{% module Explain(**d, editor=True, allow_del=True) %}
						{% elif d["type"] == "code" %}
							{% module Code(**d, user=user, allow_del=True) %}
						{% end %}
						{% module NodeControl(question=False) %}
					{% end %}

				{% elif (user == 0) and (editable) %}
					{% module NodeControl(question=False, explain=False) %}
					{% for ans in saved_answers %}
						{% module Code(content=ans, allow_del=True) %}
						{% module NodeControl(question=False, explain=False) %}
					{% end %}

				{% elif (user == 0) and (not editable) %}
					{% set i = 0 %}
					{% for d in conponent %}
						{% if d["type"] == "explain" %}
							{% module Explain(**d) %}
						{% elif d["type"] == "code" %}
							{% if len(saved_answers) > i %}
								{% module Code(content=saved_answers[i], ) %}
								{% set i = i + 1%}
							{% else %}
								{% module Code(**d) %}
							{% end %}

						{% end %}
					{% end %}
				{% end %}
			</div>

			{% if user == 1 %}
				<div class="test-code mt-2">
					<p class="mb-0"><span class="badge bg-danger">Test Code</span></p>
					{% module Code(content=answers, allow_del=False, user=0) %}
				</div>
			{% end %}
		{% end %}
	</div>
	<div class="card-footer position-relative d-flex justify-content-end">
		<button type="button" class="btn btn-success btn-sm btn-testing me-2">Answer</button>
		<button type="button" class="btn btn-danger btn-sm btn-cancel">Cancel</button>
	</div>
</div>