{% extends "layout.html" %}

{% block head %}
{% end %}

{% block head-nav-li %}
<li class="nav-item px-4">
    <a href="/" class="nav-link text-light">Home</a>
</li>
<li class="nav-item px-4">
    <a href="" class="nav-link text-light disabled">prev</a>
</li>
<li class="nav-item px-4">
    <a href="" class="nav-link text-light disabled">next</a>
</li>
{% end %}

{% block side-content %}
<p class="fs-5 fw-bold border-bottom px-2">SideMenu</p>
{% module Template("modules/side_kernel_ops.html") %}
<div class="accordion" id="accordionExample">
    <div class="accordion-item">
        <h2 class="accordion-header">
            <button class="accordion-button py-2" type="button" data-bs-toggle="collapse" data-bs-target="#collapseProgress" aria-expanded="true" aria-controls="collapseProgress">
            Progress
            </button>
        </h2>
        <div id="collapseProgress" class="accordion-collapse collapse show">
            <div class="accordion-body px-1 ">
                <div class="list-group list-group-flush" style="font-size: 0.9rem;">
                    {% for d in progress %}
                        <a class="list-group-item pe-0 ps-1 py-1 rounded {% if conponent['id'] == d['id'] %} list-group-item-secondary {% end %}" href="/problems/{{ d['id'] }}">
                            {% if d["status"] == 0 %}
                            <i class="bi bi-circle text-dark"></i>
                            {% elif d["status"] == 1 %} 
                                <i class="bi bi-triangle text-warning"></i>
                            {% elif d["status"] == 2 %}
                                <i class="bi bi-check2-circle text-success"></i>
                            {% end %}
                            {{ d["title"] }}
                        </a>
                    {% end %}
                </div>
            </div>
        </div>
    </div>
    <div class="accordion-item">
        <h2 class="accordion-header">
            <button class="accordion-button collapsed py-2" type="button" data-bs-toggle="collapse" data-bs-target="#collapseKernel" aria-expanded="false" aria-controls="collapseKernel">
            Running Kernel
            </button>
        </h2>
        <div id="collapseKernel" class="accordion-collapse collapse">
            <div class="accordion-body px-1">
                <div class="list-group list-group-flush">
                    {% for d in progress %}
                        <a class="list-group-item pe-0 ps-1 py-1 rounded" href="/problems/{{ d['id'] }}">
                            <i class="bi bi-circle-fill text-success" status="{{ d['status'] }}"></i>
                            {{ d['title'] }}
                        </a>
                    {% end %}
                </div>
            </div>
        </div>
    </div>
</div>
{% end %}

{% block main %}
<main class="col px-3">
    <div class="my-3" id="summary">
        <p class="fs-3 border-bottom border-dark ps-1">Problem: {{ conponent["title"] }}</p>
        <div class="ps-3">
            <nav>
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                  <button class="nav-link active" id="nav-summary-tab" data-bs-toggle="tab" data-bs-target="#navSummary" type="button" role="tab" aria-controls="navSummary" aria-selected="true">Summary</button>
                  <button class="nav-link" id="nav-data-tab" data-bs-toggle="tab" data-bs-target="#navData" type="button" role="tab" aria-controls="navData" aria-selected="false">Data Source</button>
                  <button class="nav-link" id="nav-env-tab" data-bs-toggle="tab" data-bs-target="#navEnv" type="button" role="tab" aria-controls="navEnv" aria-selected="false">Environment</button>
                </div>
            </nav>
            <div class="tab-content border bg-light" id="nav-tabContent">
                <div class="tab-pane fade show active p-2" id="navSummary" role="tabpanel" aria-labelledby="nav-summary-tab">
                    {% raw conponent["page"]["header"]["summary"] %}
                </div>
                <div class="tab-pane fade p-2" id="navData" role="tabpanel" aria-labelledby="nav-data-tab">
                    {% raw conponent["page"]["header"]["source"] %}
                </div>
                <div class="tab-pane fade p-2" id="navEnv" role="tabpanel" aria-labelledby="nav-env-tab">
                    {% raw conponent["page"]["header"]["env"] %}
                </div>
            </div>
        </div>
    </div>
    <div id="sourceCode">
        <p class="fs-3 border-bottom border-dark ps-1">The Source Code</p>
        <div id="">
            {% for d in conponent["page"]["body"]%}
                {% if d["type"] == "code" %}
                    {% module Code(**d) %}
                {% elif d["type"] == "explain" %}
                    {% module Explain(**d) %}
                {% elif d["type"] == "question" %}
                    {% module Question(**d, progress=conponent['q_status'].get(str(d['q_id']), 0)) %}
                {% end %}
            {% end %}
    </div>
</main>
<div class="col-xxl-2 bg-white border-start">
    <div class="sticky-top d-none d-xxl-block" id="sideItem">
        <p class="fw-bold border-bottom mb-1 mt-3">Items</p>
        <nav id="navbar-example3" class="flex-column align-items-stretch pe-4">
            <nav class="nav nav-pills flex-column">
                <a class="nav-link" href="#item-1">Item 1</a>
                <nav class="nav nav-pills flex-column">
                    <a class="nav-link ms-3 my-1" href="#item-1-1">Item 1-1</a>
                    <a class="nav-link ms-3 my-1" href="#item-1-2">Item 1-2</a>
                </nav>
                <a class="nav-link" href="#item-2">Item 2</a>
                <a class="nav-link" href="#item-3">Item 3</a>
                <nav class="nav nav-pills flex-column">
                    <a class="nav-link ms-3 my-1" href="#item-3-1">Item 3-1</a>
                    <a class="nav-link ms-3 my-1" href="#item-3-2">Item 3-2</a>
                </nav>
            </nav>
        </nav>
    </div>
</div>

<script src="{{ static_url('js/problems_test.js') }}"></script>
<script>
    document.querySelectorAll(".question .q-text > *[ans]").forEach(elem => {
        elem.removeAttribute("ans")
    })
</script>
{% end %}